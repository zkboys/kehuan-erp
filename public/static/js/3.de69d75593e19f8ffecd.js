webpackJsonp([3],{1378:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PAGE_ROUTE=void 0;var i,l,c,u=(n(606),n(605)),p=o(u),f=(n(36),n(64)),h=o(f),y=(n(82),n(81)),g=o(y),v=(n(277),n(176)),b=o(v),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),k=n(0),K=o(k),E=n(63),x=n(175),N=n(110),S=n(1397),O=o(S),C=b.default.Option,D="UN_SAVED_NEW_NODE_KEY",w=(t.PAGE_ROUTE="/system/menu",i=(0,x.ajax)(),l=g.default.create(),i(c=l(c=function(e){function t(){var e,n,o,d;a(this,t);for(var i=arguments.length,l=Array(i),c=0;c<i;c++)l[c]=arguments[c];return n=o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.state={dataSource:[],selectedKey:""},o.handleAddNewNode=function(e){var t=[].concat(r(o.state.dataSource)),n=o.props.form.setFieldsValue,a={key:D,parentKey:e,type:"0",text:"新增节点",icon:"fa-lock",path:"",order:100};t.push(a),n(a),o.setState({dataSource:t,selectedKey:D})},o.handleTreeSelect=function(e){if(e){var t=o.props.form.setFieldsValue;"0"===e.type&&t({key:e.key,parentKey:e.parentKey,type:e.type,text:e.text,path:e.path,icon:e.icon,order:e.order}),"1"===e.type&&t({key:e.key,parentKey:e.parentKey,type:e.type,text:e.text,code:e.code}),o.setState({selectedKey:e.key})}},o.handleReset=function(){var e=o.state,t=e.selectedKey,n=e.dataSource,r=n.find(function(e){return e.key===t});o.handleTreeSelect(r)},o.handleSubmit=function(e){var t=o.state.dataSource,n=o.props.$ajax,r=t.find(function(e){return e.key===D}),a=void 0;r?(e.key=null,a="添加成功！",n.post("/system/menus",e,{successTip:a}).then(function(e){var n=e,r=t.filter(function(e){return e.key!==D});r.push(n),o.setState({dataSource:r,selectedKey:n.key}),o.handleTreeSelect(n)})):(a="修改成功！",n.put("/system/menus",e,{successTip:a}).then(function(){var n=t.filter(function(t){return t.key!==e.key});n.push(e),o.setState({dataSource:n,selectedKey:e.key}),o.handleTreeSelect(e)}))},o.handleDelete=function(){var e=o.state,t=e.dataSource,n=e.selectedKey;if(n===D){var r=t.filter(function(e){return e.key!==D});o.setState({dataSource:r}),o.props.form.resetFields(),o.setState({selectedKey:""})}else o.props.$ajax.del("/system/menus/"+n,null,{successTip:"删除成功！"}).then(function(){o.props.form.resetFields();var e=(0,N.getGenerationsByKey)(t,n),r=e.map(function(e){return e.key}),a=t.filter(function(e){return!r.includes(e.key)});o.setState({dataSource:a,selectedKey:""})})},d=n,s(o,d)}return d(t,e),m(t,[{key:"componentWillMount",value:function(){this.getAllMenus()}},{key:"getAllMenus",value:function(){var e=this;this.props.$ajax.get("/system/menus").then(function(t){var n=(t||[]).filter(function(e){return e.key});e.setState({dataSource:n})})}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.form,o=n.getFieldDecorator,r=n.getFieldValue,a=n.setFieldsValue,s=this.state,d=s.dataSource,i=s.selectedKey,l=!i;return K.default.createElement(E.PageContent,null,K.default.createElement(O.default,{form:t,dataSource:d,selectedKey:i,unSavedNewNodeKey:D,onSelect:this.handleTreeSelect,onDelete:this.handleDelete,onSubmit:this.handleSubmit,onAddTopNode:this.handleAddNewNode,onAddSubNode:this.handleAddNewNode,onReset:this.handleReset},K.default.createElement(g.default,{onSubmit:this.handleSubmit,style:{marginTop:12}},o("key")(K.default.createElement(h.default,{type:"hidden"})),o("parentKey")(K.default.createElement(h.default,{type:"hidden"})),K.default.createElement(E.FormItemLayout,{label:"类型",labelSpaceCount:2,width:300},o("type",{initialValue:"0",rules:[{required:!0,message:"请选择类型"}]})(K.default.createElement(b.default,{disabled:l},K.default.createElement(C,{value:"0"},"菜单"),K.default.createElement(C,{value:"1"},"功能")))),K.default.createElement(E.FormItemLayout,{label:"名称",labelSpaceCount:2,width:300},o("text",{rules:[{required:!0,message:"请输入菜单名称"}]})(K.default.createElement(h.default,{placeholder:"请输入菜单名称",disabled:l}))),K.default.createElement(E.FormItemLayout,{label:"编码",labelSpaceCount:2,width:300,style:{display:"1"===r("type")?"block":"none"}},o("code",{rules:[{required:"1"===r("type"),message:"请输入功能编码"}]})(K.default.createElement(h.default,{placeholder:"请输入功能编码",disabled:l}))),K.default.createElement("div",{style:{display:"0"===r("type")?"block":"none"}},K.default.createElement(E.FormItemLayout,{label:"路径",labelSpaceCount:2,width:300},o("path",{rules:[{required:!1,message:"请输入菜单路径"}]})(K.default.createElement(h.default,{placeholder:"请输入菜单路径",disabled:l}))),K.default.createElement("div",null,K.default.createElement(E.FormItemLayout,{label:"图标",labelSpaceCount:2,width:190,float:!0},o("icon",{rules:[{required:!1,message:"请输入菜单图标"}]})(K.default.createElement(h.default,{placeholder:"请输入菜单图标",disabled:l}))),K.default.createElement("div",{style:{float:"left",width:110,textAlign:"right"}},K.default.createElement(E.FontIconModal,{disabled:l,value:r("icon"),onSelect:function(e){return a({icon:e})}})),K.default.createElement("div",{style:{clear:"both"}})),K.default.createElement(E.FormItemLayout,{label:"排序",labelSpaceCount:2,width:300},o("order",{rules:[{required:!1,message:"请输入菜单排序"}]})(K.default.createElement(p.default,{style:{width:"100%"},step:1,placeholder:"请输入整数",disabled:l})))))))}}]),t}(k.Component))||c)||c);t.default=w},1388:function(e,t,n){"use strict";function o(e){var t=void 0,n=e.userAgent,o=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(o[1])?(t=/\brv[ :]+(\d+)/g.exec(n)||[],"IE "+(t[1]||"")):"Chrome"===o[1]&&(t=n.match(/\b(OPR|Edge)\/(\d+)/))?t.slice(1).join(" ").replace("OPR","Opera"):(o=o[2]?[o[1],o[2]]:[e.appName,e.appVersion,"-?"],t=n.match(/version\/(\d+)/i),t&&o.splice(1,1,t[1]),o.join(" "))}function r(e){var t=void 0,n=void 0,o=void 0,r=void 0;return e.getClientRects().length?(r=e.getBoundingClientRect(),r.width||r.height?(t=e.ownerDocument,n=t.defaultView,o=t.documentElement,{top:r.top+n.pageYOffset-o.clientTop,left:r.left+n.pageXOffset-o.clientLeft}):r):{top:0,left:0}}function a(e){var t=1;return Array.isArray(e)&&(t=e.length),t}function s(e,t,n){return 1===t?(n.first=!0,n.last=!0):(n.first=0===e,n.last=e===t-1),n}function d(e,t,n){!function e(n,o,r){var d=a(n);v.default.Children.forEach(n,function(n,a){var i=o+"-"+a;n.props.children&&n.type&&n.type.isTreeNode&&e(n.props.children,i,{node:n,pos:i}),t(n,a,i,n.key||i,s(a,d,{}),r)})}(e,0,n)}function i(e,t){return e.every(function(e,n){return e===t[n]})}function l(e){var t={};e.forEach(function(e){var n=e.split("-").length;t[n]||(t[n]=[]),t[n].push(e)});for(var n=Object.keys(t).sort(function(e,t){return Number(e)-Number(t)}),o=0;o<n.length;o++)!function(e){n[e+1]&&t[n[e]].forEach(function(o){for(var r=e+1;r<n.length;r++)!function(e){t[n[e]].forEach(function(r,a){i(o.split("-"),r.split("-"))&&(t[n[e]][a]=null)}),t[n[e]]=t[n[e]].filter(function(e){return e})}(r)})}(o);var r=[];return n.forEach(function(e){r=r.concat(t[e])}),r}function c(e){var t=e.match(/(.+)(-[^-]+)$/),n="";return t&&3===t.length&&(n=t[1]),n}function u(e){return e.split("-")}function p(e,t,n){var o=Object.keys(e);o.forEach(function(r,a){var s=u(r),d=!1;t.forEach(function(t){var l=u(t);s.length>l.length&&i(l,s)&&(e[r].halfChecked=!1,e[r].checked=n,o[a]=null),s[0]===l[0]&&s[1]===l[1]&&(d=!0)}),d||(o[a]=null)}),o=o.filter(function(e){return e});for(var r=0;r<t.length;r++)!function(n){!function r(a){var s=u(a).length;if(!(s<=2)){var d=0,l=0,p=c(a);o.forEach(function(o){var r=u(o);if(r.length===s&&i(u(p),r))if(d++,e[o].checked){l++;var a=t.indexOf(o);a>-1&&(t.splice(a,1),a<=n&&n--)}else e[o].halfChecked&&(l+=.5)});var f=e[p];0===l?(f.checked=!1,f.halfChecked=!1):l===d?(f.checked=!0,f.halfChecked=!1):(f.halfChecked=!0,f.checked=!1),r(p)}}(t[n]),r=n}(r)}function f(e){var t=[],n=[],o=[],r=[];return Object.keys(e).forEach(function(a){var s=e[a];s.checked?(n.push(s.key),o.push(s.node),r.push({node:s.node,pos:a})):s.halfChecked&&t.push(s.key)}),{halfCheckedKeys:t,checkedKeys:n,checkedNodes:o,checkedNodesPositions:r,treeNodesStates:e}}function h(e,t){return t?{checked:e,halfChecked:t}:e}function y(e,t){if(e===t)return!0;if(null===e||void 0===e||null===t||void 0===t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.browser=o,t.getOffset=r,t.loopAllChildren=d,t.isInclude=i,t.filterParentPosition=l,t.handleCheckState=p,t.getCheck=f,t.getStrictlyValue=h,t.arraysEqual=y;var g=n(0),v=function(e){return e&&e.__esModule?e:{default:e}}(g)},1389:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var r=n[o],a=Object.getOwnPropertyDescriptor(t,r);a&&a.configurable&&void 0===e[r]&&Object.defineProperty(e,r,a)}return e}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):r(e,t))}function l(){}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=n(0),p=o(u),f=n(2),h=o(f),y=n(10),g=o(y),v=n(8),b=o(v),m=n(1388),k=function(e){function t(n){s(this,t);var o=d(this,e.call(this,n));return["onKeyDown","onCheck"].forEach(function(e){o[e]=o[e].bind(o)}),o.contextmenuKeys=[],o.checkedKeysChange=!0,o.state={expandedKeys:o.getDefaultExpandedKeys(n),checkedKeys:o.getDefaultCheckedKeys(n),selectedKeys:o.getDefaultSelectedKeys(n),dragNodesKeys:"",dragOverNodeKey:"",dropNodeKey:""},o}return i(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this.getDefaultExpandedKeys(e,!0),n=this.getDefaultCheckedKeys(e,!0),o=this.getDefaultSelectedKeys(e,!0),r={};t&&(r.expandedKeys=t),n&&(e.checkedKeys===this.props.checkedKeys?this.checkedKeysChange=!1:this.checkedKeysChange=!0,r.checkedKeys=n),o&&(r.selectedKeys=o),this.setState(r)},t.prototype.onDragStart=function(e,t){this.dragNode=t,this.dragNodesKeys=this.getDragNodes(t);var n={dragNodesKeys:this.dragNodesKeys},o=this.getExpandedKeys(t,!1);o&&(this.getRawExpandedKeys(),n.expandedKeys=o),this.setState(n),this.props.onDragStart({event:e,node:t}),this._dropTrigger=!1},t.prototype.onDragEnterGap=function(e,t){var n=(0,m.getOffset)(t.refs.selectHandle).top,o=t.refs.selectHandle.offsetHeight,r=e.pageY;return r>n+o-2?(this.dropPosition=1,1):r<n+2?(this.dropPosition=-1,-1):(this.dropPosition=0,0)},t.prototype.onDragEnter=function(e,t){var n=this.onDragEnterGap(e,t);if(this.dragNode.props.eventKey===t.props.eventKey&&0===n)return void this.setState({dragOverNodeKey:""});var o={dragOverNodeKey:t.props.eventKey},r=this.getExpandedKeys(t,!0);r&&(this.getRawExpandedKeys(),o.expandedKeys=r),this.setState(o),this.props.onDragEnter({event:e,node:t,expandedKeys:r&&[].concat(a(r))||[].concat(a(this.state.expandedKeys))})},t.prototype.onDragOver=function(e,t){this.props.onDragOver({event:e,node:t})},t.prototype.onDragLeave=function(e,t){this.props.onDragLeave({event:e,node:t})},t.prototype.onDrop=function(e,t){var n=t.props.eventKey;if(this.setState({dragOverNodeKey:"",dropNodeKey:n}),this.dragNodesKeys.indexOf(n)>-1)return console.warn&&console.warn("can not drop to dragNode(include it's children node)"),!1;var o=t.props.pos.split("-"),r={event:e,node:t,dragNode:this.dragNode,dragNodesKeys:[].concat(a(this.dragNodesKeys)),dropPosition:this.dropPosition+Number(o[o.length-1])};0!==this.dropPosition&&(r.dropToGap=!0),"expandedKeys"in this.props&&(r.rawExpandedKeys=[].concat(a(this._rawExpandedKeys))||[].concat(a(this.state.expandedKeys))),this.props.onDrop(r),this._dropTrigger=!0},t.prototype.onDragEnd=function(e,t){this.setState({dragOverNodeKey:""}),this.props.onDragEnd({event:e,node:t})},t.prototype.onExpand=function(e){var t=this,n=!e.props.expanded,o="expandedKeys"in this.props,r=[].concat(a(this.state.expandedKeys)),s=r.indexOf(e.props.eventKey);if(n&&-1===s?r.push(e.props.eventKey):!n&&s>-1&&r.splice(s,1),o||this.setState({expandedKeys:r}),this.props.onExpand(r,{node:e,expanded:n}),n&&this.props.loadData)return this.props.loadData(e).then(function(){o||t.setState({expandedKeys:r})})},t.prototype.onCheck=function(e){var t=this,n=!e.props.checked;e.props.halfChecked&&(n=!0);var o=e.props.eventKey,r=[].concat(a(this.state.checkedKeys)),s=r.indexOf(o),d={event:"check",node:e,checked:n};if(this.props.checkStrictly){n&&-1===s&&r.push(o),!n&&s>-1&&r.splice(s,1),d.checkedNodes=[],(0,m.loopAllChildren)(this.props.children,function(e,t,n,o){-1!==r.indexOf(o)&&d.checkedNodes.push(e)}),"checkedKeys"in this.props||this.setState({checkedKeys:r});var i=this.props.checkedKeys?this.props.checkedKeys.halfChecked:[];this.props.onCheck((0,m.getStrictlyValue)(r,i),d)}else{if(n&&-1===s){this.treeNodesStates[e.props.pos].checked=!0;var l=[];Object.keys(this.treeNodesStates).forEach(function(e){t.treeNodesStates[e].checked&&l.push(e)}),(0,m.handleCheckState)(this.treeNodesStates,(0,m.filterParentPosition)(l),!0)}n||(this.treeNodesStates[e.props.pos].checked=!1,this.treeNodesStates[e.props.pos].halfChecked=!1,(0,m.handleCheckState)(this.treeNodesStates,[e.props.pos],!1));var c=(0,m.getCheck)(this.treeNodesStates);d.checkedNodes=c.checkedNodes,d.checkedNodesPositions=c.checkedNodesPositions,d.halfCheckedKeys=c.halfCheckedKeys,this.checkKeys=c,this._checkedKeys=r=c.checkedKeys,"checkedKeys"in this.props||this.setState({checkedKeys:r}),this.props.onCheck(r,d)}},t.prototype.onSelect=function(e){var t=this.props,n=[].concat(a(this.state.selectedKeys)),o=e.props.eventKey,r=n.indexOf(o),s=void 0;-1!==r?(s=!1,n.splice(r,1)):(s=!0,t.multiple||(n.length=0),n.push(o));var d=[];n.length&&(0,m.loopAllChildren)(this.props.children,function(e){-1!==n.indexOf(e.key)&&d.push(e)});var i={event:"select",node:e,selected:s,selectedNodes:d};"selectedKeys"in this.props||this.setState({selectedKeys:n}),t.onSelect(n,i)},t.prototype.onMouseEnter=function(e,t){this.props.onMouseEnter({event:e,node:t})},t.prototype.onMouseLeave=function(e,t){this.props.onMouseLeave({event:e,node:t})},t.prototype.onContextMenu=function(e,t){var n=[].concat(a(this.state.selectedKeys)),o=t.props.eventKey;-1===this.contextmenuKeys.indexOf(o)&&this.contextmenuKeys.push(o),this.contextmenuKeys.forEach(function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}),-1===n.indexOf(o)&&n.push(o),this.setState({selectedKeys:n}),this.props.onRightClick({event:e,node:t})},t.prototype.onKeyDown=function(e){e.preventDefault()},t.prototype.getFilterExpandedKeys=function(e,t,n){var o=e[t];if(!n&&!e.autoExpandParent)return o||[];var r=[];e.autoExpandParent&&(0,m.loopAllChildren)(e.children,function(e,t,n,a){o.indexOf(a)>-1&&r.push(n)});var a=[];return(0,m.loopAllChildren)(e.children,function(t,o,s,d){n?a.push(d):e.autoExpandParent&&r.forEach(function(e){(e.split("-").length>s.split("-").length&&(0,m.isInclude)(s.split("-"),e.split("-"))||s===e)&&-1===a.indexOf(d)&&a.push(d)})}),a.length?a:o},t.prototype.getDefaultExpandedKeys=function(e,t){var n=t?void 0:this.getFilterExpandedKeys(e,"defaultExpandedKeys",!e.defaultExpandedKeys.length&&e.defaultExpandAll);return"expandedKeys"in e&&(n=(e.autoExpandParent?this.getFilterExpandedKeys(e,"expandedKeys",!1):e.expandedKeys)||[]),n},t.prototype.getDefaultCheckedKeys=function(e,t){var n=t?void 0:e.defaultCheckedKeys;return"checkedKeys"in e&&(n=e.checkedKeys||[],e.checkStrictly&&(e.checkedKeys.checked?n=e.checkedKeys.checked:Array.isArray(e.checkedKeys)||(n=[]))),n},t.prototype.getDefaultSelectedKeys=function(e,t){var n=function(t){return e.multiple?[].concat(a(t)):t.length?[t[0]]:t},o=t?void 0:n(e.defaultSelectedKeys);return"selectedKeys"in e&&(o=n(e.selectedKeys)),o},t.prototype.getRawExpandedKeys=function(){!this._rawExpandedKeys&&"expandedKeys"in this.props&&(this._rawExpandedKeys=[].concat(a(this.state.expandedKeys)))},t.prototype.getOpenTransitionName=function(){var e=this.props,t=e.openTransitionName,n=e.openAnimation;return t||"string"!=typeof n||(t=e.prefixCls+"-open-"+n),t},t.prototype.getDragNodes=function(e){var t=[],n=e.props.pos.split("-");return(0,m.loopAllChildren)(this.props.children,function(o,r,a,s){var d=a.split("-");(e.props.pos===a||n.length<d.length&&(0,m.isInclude)(n,d))&&t.push(s)}),t},t.prototype.getExpandedKeys=function(e,t){var n=e.props.eventKey,o=this.state.expandedKeys,r=o.indexOf(n),s=void 0;return r>-1&&!t?(s=[].concat(a(o)),s.splice(r,1),s):t&&-1===o.indexOf(n)?o.concat([n]):void 0},t.prototype.filterTreeNode=function(e){var t=this.props.filterTreeNode;return"function"==typeof t&&!e.props.disabled&&t.call(this,e)},t.prototype.renderTreeNode=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=n+"-"+t,r=e.key||o,a=this.state,s=this.props,d=s.selectable;e.props.hasOwnProperty("selectable")&&(d=e.props.selectable);var i={ref:"treeNode-"+r,root:this,eventKey:r,pos:o,selectable:d,loadData:s.loadData,onMouseEnter:s.onMouseEnter,onMouseLeave:s.onMouseLeave,onRightClick:s.onRightClick,prefixCls:s.prefixCls,showLine:s.showLine,showIcon:s.showIcon,draggable:s.draggable,dragOver:a.dragOverNodeKey===r&&0===this.dropPosition,dragOverGapTop:a.dragOverNodeKey===r&&-1===this.dropPosition,dragOverGapBottom:a.dragOverNodeKey===r&&1===this.dropPosition,_dropTrigger:this._dropTrigger,expanded:-1!==a.expandedKeys.indexOf(r),selected:-1!==a.selectedKeys.indexOf(r),openTransitionName:this.getOpenTransitionName(),openAnimation:s.openAnimation,filterTreeNode:this.filterTreeNode.bind(this)};return s.checkable&&(i.checkable=s.checkable,s.checkStrictly?(a.checkedKeys&&(i.checked=-1!==a.checkedKeys.indexOf(r)||!1),s.checkedKeys&&s.checkedKeys.halfChecked?i.halfChecked=-1!==s.checkedKeys.halfChecked.indexOf(r)||!1:i.halfChecked=!1):(this.checkedKeys&&(i.checked=-1!==this.checkedKeys.indexOf(r)||!1),i.halfChecked=-1!==this.halfCheckedKeys.indexOf(r))),this.treeNodesStates&&this.treeNodesStates[o]&&(0,g.default)(i,this.treeNodesStates[o].siblingPosition),p.default.cloneElement(e,i)},t.prototype.render=function(){var e=this,t=this.props,n={className:(0,b.default)(t.className,t.prefixCls),role:"tree-node"};t.focusable&&(n.tabIndex="0",n.onKeyDown=this.onKeyDown);var o=function(){e.treeNodesStates={},(0,m.loopAllChildren)(t.children,function(t,n,o,r,a){e.treeNodesStates[o]={siblingPosition:a}})};if(t.showLine&&!t.checkable&&o(),t.checkable&&(this.checkedKeysChange||t.loadData))if(t.checkStrictly)o();else if(t._treeNodesStates)this.treeNodesStates=t._treeNodesStates.treeNodesStates,this.halfCheckedKeys=t._treeNodesStates.halfCheckedKeys,this.checkedKeys=t._treeNodesStates.checkedKeys;else{var r=this.state.checkedKeys,a=void 0;if(!t.loadData&&this.checkKeys&&this._checkedKeys&&(0,m.arraysEqual)(this._checkedKeys,r))a=this.checkKeys;else{var s=[];this.treeNodesStates={},(0,m.loopAllChildren)(t.children,function(t,n,o,a,d){e.treeNodesStates[o]={node:t,key:a,checked:!1,halfChecked:!1,siblingPosition:d},-1!==r.indexOf(a)&&(e.treeNodesStates[o].checked=!0,s.push(o))}),(0,m.handleCheckState)(this.treeNodesStates,(0,m.filterParentPosition)(s),!0),a=(0,m.getCheck)(this.treeNodesStates)}this.halfCheckedKeys=a.halfCheckedKeys,this.checkedKeys=a.checkedKeys}return p.default.createElement("ul",c({},n,{unselectable:!0,ref:"tree"}),p.default.Children.map(t.children,this.renderTreeNode,this))},t}(p.default.Component);k.propTypes={prefixCls:h.default.string,children:h.default.any,showLine:h.default.bool,showIcon:h.default.bool,selectable:h.default.bool,multiple:h.default.bool,checkable:h.default.oneOfType([h.default.bool,h.default.node]),_treeNodesStates:h.default.object,checkStrictly:h.default.bool,draggable:h.default.bool,autoExpandParent:h.default.bool,defaultExpandAll:h.default.bool,defaultExpandedKeys:h.default.arrayOf(h.default.string),expandedKeys:h.default.arrayOf(h.default.string),defaultCheckedKeys:h.default.arrayOf(h.default.string),checkedKeys:h.default.oneOfType([h.default.arrayOf(h.default.string),h.default.object]),defaultSelectedKeys:h.default.arrayOf(h.default.string),selectedKeys:h.default.arrayOf(h.default.string),onExpand:h.default.func,onCheck:h.default.func,onSelect:h.default.func,loadData:h.default.func,onMouseEnter:h.default.func,onMouseLeave:h.default.func,onRightClick:h.default.func,onDragStart:h.default.func,onDragEnter:h.default.func,onDragOver:h.default.func,onDragLeave:h.default.func,onDrop:h.default.func,onDragEnd:h.default.func,filterTreeNode:h.default.func,openTransitionName:h.default.string,openAnimation:h.default.oneOfType([h.default.string,h.default.object])},k.defaultProps={prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,checkStrictly:!1,draggable:!1,autoExpandParent:!0,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],onExpand:l,onCheck:l,onSelect:l,onDragStart:l,onDragEnter:l,onDragOver:l,onDragLeave:l,onDrop:l,onDragEnd:l},t.default=k,e.exports=t.default},1390:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var r=n[o],a=Object.getOwnPropertyDescriptor(t,r);a&&a.configurable&&void 0===e[r]&&Object.defineProperty(e,r,a)}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):r(e,t))}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=n(0),p=o(u),f=n(2),h=o(f),y=n(10),g=o(y),v=n(8),b=o(v),m=n(65),k=o(m),K=n(1388),E=n(1392),x=o(E),N="undefined"!=typeof window?(0,K.browser)(window.navigator):"",S=/.*(IE|Edge).+/.test(N),O=function(e){function t(n){s(this,t);var o=d(this,e.call(this,n));return["onExpand","onCheck","onContextMenu","onMouseEnter","onMouseLeave","onDragStart","onDragEnter","onDragOver","onDragLeave","onDrop","onDragEnd"].forEach(function(e){o[e]=o[e].bind(o)}),o.state={dataLoading:!1,dragNodeHighlight:!1},o}return i(t,e),t.prototype.componentDidMount=function(){this.props.root._treeNodeInstances||(this.props.root._treeNodeInstances=[]),this.props.root._treeNodeInstances.push(this)},t.prototype.onCheck=function(){this.props.root.onCheck(this)},t.prototype.onSelect=function(){this.props.root.onSelect(this)},t.prototype.onMouseEnter=function(e){e.preventDefault(),this.props.root.onMouseEnter(e,this)},t.prototype.onMouseLeave=function(e){e.preventDefault(),this.props.root.onMouseLeave(e,this)},t.prototype.onContextMenu=function(e){e.preventDefault(),this.props.root.onContextMenu(e,this)},t.prototype.onDragStart=function(e){e.stopPropagation(),this.setState({dragNodeHighlight:!0}),this.props.root.onDragStart(e,this);try{e.dataTransfer.setData("text/plain","")}catch(e){}},t.prototype.onDragEnter=function(e){e.preventDefault(),e.stopPropagation(),this.props.root.onDragEnter(e,this)},t.prototype.onDragOver=function(e){return e.preventDefault(),e.stopPropagation(),this.props.root.onDragOver(e,this),!1},t.prototype.onDragLeave=function(e){e.stopPropagation(),this.props.root.onDragLeave(e,this)},t.prototype.onDrop=function(e){e.preventDefault(),e.stopPropagation(),this.setState({dragNodeHighlight:!1}),this.props.root.onDrop(e,this)},t.prototype.onDragEnd=function(e){e.stopPropagation(),this.setState({dragNodeHighlight:!1}),this.props.root.onDragEnd(e,this)},t.prototype.onExpand=function(){var e=this,t=this.props.root.onExpand(this);if(t&&"object"===(void 0===t?"undefined":c(t))){var n=function(t){e.setState({dataLoading:t})};n(!0),t.then(function(){n(!1)},function(){n(!1)})}},t.prototype.onKeyDown=function(e){e.preventDefault()},t.prototype.renderSwitcher=function(e,t){var n=e.prefixCls,o=a({},n+"-switcher",!0);return e.showLine?"0-0"===e.pos?o[n+"-roots_"+t]=!0:(o[n+"-center_"+t]=!e.last,o[n+"-bottom_"+t]=e.last):o[n+"-noline_"+t]=!0,e.disabled?(o[n+"-switcher-disabled"]=!0,p.default.createElement("span",{className:(0,b.default)(o)})):p.default.createElement("span",{className:(0,b.default)(o),onClick:this.onExpand})},t.prototype.renderCheckbox=function(e){var t=e.prefixCls,n=a({},t+"-checkbox",!0);e.checked?n[t+"-checkbox-checked"]=!0:e.halfChecked&&(n[t+"-checkbox-indeterminate"]=!0);var o=null;return"boolean"!=typeof e.checkable&&(o=e.checkable),e.disabled||e.disableCheckbox?(n[t+"-checkbox-disabled"]=!0,p.default.createElement("span",{ref:"checkbox",className:(0,b.default)(n)},o)):p.default.createElement("span",{ref:"checkbox",className:(0,b.default)(n),onClick:this.onCheck},o)},t.prototype.renderChildren=function(e){var t=this.renderFirst;this.renderFirst=1;var n=!0;!t&&e.expanded&&(n=!1);var o=e.children?(0,x.default)(e.children):e.children,r=o;if(o&&(Array.isArray(o)&&o.every(function(e){return e.type&&e.type.isTreeNode})||o.type&&o.type.isTreeNode)){var s,d=(s={},a(s,e.prefixCls+"-child-tree",!0),a(s,e.prefixCls+"-child-tree-open",e.expanded),s);e.showLine&&(d[e.prefixCls+"-line"]=!e.last);var i={};e.openTransitionName?i.transitionName=e.openTransitionName:"object"===c(e.openAnimation)&&(i.animation=(0,g.default)({},e.openAnimation),n||delete i.animation.appear),r=p.default.createElement(k.default,l({},i,{showProp:"data-expanded",transitionAppear:n,component:""}),e.expanded?p.default.createElement("ul",{className:(0,b.default)(d),"data-expanded":e.expanded},p.default.Children.map(o,function(t,n){return e.root.renderTreeNode(t,n,e.pos)},e.root)):null)}return r},t.prototype.render=function(){var e,t=this,n=this.props,o=n.prefixCls,r=n.expanded?"open":"close",s=r,d=!0,i=n.title,c=this.renderChildren(n);c&&c!==n.children||(c=null,n.loadData&&!n.isLeaf||(d=!1,s="docu"));var u=(e={},a(e,o+"-iconEle",!0),a(e,o+"-icon_loading",this.state.dataLoading),a(e,o+"-icon__"+s,!0),e),f={};n.draggable&&(f.onDragEnter=this.onDragEnter,f.onDragOver=this.onDragOver,f.onDragLeave=this.onDragLeave,f.onDrop=this.onDrop,f.onDragEnd=this.onDragEnd);var h="",y="";n.disabled?h=o+"-treenode-disabled":n.dragOver?y="drag-over":n.dragOverGapTop?y="drag-over-gap-top":n.dragOverGapBottom&&(y="drag-over-gap-bottom");var g=n.filterTreeNode(this)?"filter-node":"";return p.default.createElement("li",l({},f,{ref:"li",className:(0,b.default)(n.className,h,y,g)}),d?this.renderSwitcher(n,r):function(){var e,t=(e={},a(e,o+"-switcher",!0),a(e,o+"-switcher-noop",!0),e);return n.showLine?(t[o+"-center_docu"]=!n.last,t[o+"-bottom_docu"]=n.last):t[o+"-noline_docu"]=!0,p.default.createElement("span",{className:(0,b.default)(t)})}(),n.checkable?this.renderCheckbox(n):null,function(){var e=n.showIcon||n.loadData&&t.state.dataLoading?p.default.createElement("span",{className:(0,b.default)(u)}):null,a=p.default.createElement("span",{className:o+"-title"},i),d=o+"-node-content-wrapper",c={className:d+" "+d+"-"+(s===r?s:"normal")};return n.disabled||((n.selected||!n._dropTrigger&&t.state.dragNodeHighlight)&&(c.className+=" "+o+"-node-selected"),c.onClick=function(e){e.preventDefault(),n.selectable&&t.onSelect()},n.onRightClick&&(c.onContextMenu=t.onContextMenu),n.onMouseEnter&&(c.onMouseEnter=t.onMouseEnter),n.onMouseLeave&&(c.onMouseLeave=t.onMouseLeave),n.draggable&&(c.className+=" draggable",S&&(c.href="#"),c.draggable=!0,c["aria-grabbed"]=!0,c.onDragStart=t.onDragStart)),p.default.createElement("span",l({ref:"selectHandle",title:"string"==typeof i?i:""},c),e,a)}(),c)},t}(p.default.Component);O.isTreeNode=1,O.propTypes={prefixCls:h.default.string,disabled:h.default.bool,disableCheckbox:h.default.bool,expanded:h.default.bool,isLeaf:h.default.bool,root:h.default.object,onSelect:h.default.func},O.defaultProps={title:"---"},t.default=O,e.exports=t.default},1391:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1389),a=o(r),s=n(1390),d=o(s);a.default.TreeNode=d.default,t.default=a.default,e.exports=t.default},1392:function(e,t,n){"use strict";function o(e){var t=[];return a.default.Children.forEach(e,function(e){t.push(e)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(r);e.exports=t.default},1393:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AntTreeNode=void 0;var r=n(7),a=o(r),s=n(9),d=o(s),i=n(3),l=o(i),c=n(6),u=o(c),p=n(5),f=o(p),h=n(4),y=o(h),g=n(0),v=o(g),b=n(1391),m=o(b),k=n(611),K=o(k),E=n(8),x=o(E),N=(t.AntTreeNode=function(e){function t(){return(0,l.default)(this,t),(0,f.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){return v.default.createElement(t,this.props)}}]),t}(v.default.Component),function(e){function t(){return(0,l.default)(this,t),(0,f.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.prefixCls,n=e.className,o=e.showLine,r=e.checkable,s=(0,x.default)((0,d.default)({},t+"-show-line",!!o),n);return v.default.createElement(m.default,(0,a.default)({},e,{className:s,checkable:r?v.default.createElement("span",{className:t+"-checkbox-inner"}):r}),this.props.children)}}]),t}(v.default.Component));t.default=N,N.TreeNode=b.TreeNode,N.defaultProps={prefixCls:"ant-tree",checkable:!1,showIcon:!1,openAnimation:K.default}},1394:function(e,t,n){"use strict";n(15),n(1395),n(278)},1395:function(e,t){},1397:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,l,c=(n(610),n(609)),u=o(c),p=(n(282),n(281)),f=o(p),h=(n(608),n(607)),y=o(h),g=(n(35),n(31)),v=o(g),b=(n(138),n(137)),m=o(b),k=(n(1394),n(1393)),K=o(k),E=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),x=n(0),N=o(x),S=n(2),O=o(S),C=n(63),D=n(83),w=n(110),_=K.default.TreeNode,P=(l=i=function(e){function t(){var e,n,o,d;a(this,t);for(var i=arguments.length,l=Array(i),c=0;c<i;c++)l[c]=arguments[c];return n=o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.state={expandedKeys:[]},o.handleAddNewNode=function(e){var t=o.props,n=t.dataSource,a=t.selectedKey,s=t.onAddTopNode,d=t.onAddSubNode,i=t.unSavedNewNodeKey,l=n.find(function(e){return e.key===i});if("subNode"===e&&!a)return m.default.error("请选择一个父节点！",3);if(l)return m.default.error("您有未保存的新增节点！",3);if("subNode"===e){d(a);var c=[].concat(r(o.state.expandedKeys));c.push(i),c.push(a),c=(0,D.uniqueArray)(c),o.setState({expandedKeys:c})}else"topNode"===e&&s()},o.handleExpand=function(e){o.setState({expandedKeys:e})},o.handleTreeSelect=function(e){var t=o.props,n=t.dataSource,r=t.onSelect,a=t.unSavedNewNodeKey;if(n.find(function(e){return e.key===a}))return m.default.error("您有未保存的新增节点！",3);var s=n.find(function(t){return t.key===e[0]});s&&r(s)},o.handleSubmit=function(e){e.preventDefault();var t=o.props,n=t.form,r=t.onSubmit;n.validateFields(function(e,t){e||r(t)})},o.handleReset=function(){var e=o.props,t=e.onReset,n=e.form;t?t():n.resetFields()},o.handleDelete=function(){(0,o.props.onDelete)()},d=n,s(o,d)}return d(t,e),E(t,[{key:"getTreeData",value:function(){var e=this.props.dataSource,t=[].concat(r(e)).sort(function(e,t){var n=e.order||0,o=t.order||0;return n||o?o-n:e.text>t.text?1:-1});return(0,w.convertToTree)(t)}},{key:"render",value:function(){var e=this,t=this.state.expandedKeys,n=this.props,o=n.selectedKey,r=n.unSavedNewNodeKey,a=this.getTreeData(),s=!o,d=(0,w.renderNode)(a,function(e,t){var n=e.text,o=e.key,a=e.icon;return a&&(n=N.default.createElement("span",null,N.default.createElement(C.FontIcon,{type:a})," ",e.text)),o===r&&(n=N.default.createElement("span",{style:{color:"red"}},n)),t?N.default.createElement(_,{key:o,title:n},t):N.default.createElement(_,{key:o,title:n})});return N.default.createElement(C.PageContent,null,N.default.createElement(u.default,null,N.default.createElement(y.default,{span:8},N.default.createElement(v.default,{type:"primary",onClick:function(){return e.handleAddNewNode("topNode")}},"添加顶级"),N.default.createElement(K.default,{selectedKeys:[o],expandedKeys:t,onExpand:this.handleExpand,onSelect:this.handleTreeSelect},d)),N.default.createElement(y.default,{span:16},N.default.createElement(v.default,{type:"ghost",onClick:function(){return e.handleAddNewNode("subNode")},disabled:s},"添加子节点"),N.default.createElement(f.default,{placement:"bottom",title:"您确定删除此节点吗？其子节点也将一并被删除！",onConfirm:this.handleDelete},N.default.createElement(v.default,{type:"danger",style:{marginLeft:8},disabled:s},"删除")),this.props.children,N.default.createElement(v.default,{type:"primary",onClick:this.handleSubmit,disabled:s},"保存"),N.default.createElement(v.default,{type:"ghost",style:{marginLeft:8},onClick:this.handleReset,disabled:s},"重置"))))}}]),t}(x.Component),i.propTypes={dataSource:O.default.array.isRequired,selectedKey:O.default.string.isRequired,unSavedNewNodeKey:O.default.string.isRequired,onSelect:O.default.func.isRequired,onDelete:O.default.func.isRequired,onSubmit:O.default.func.isRequired,onAddTopNode:O.default.func.isRequired,onAddSubNode:O.default.func.isRequired,onReset:O.default.func},l);t.default=P}});